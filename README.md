# Godwoken Examples

## Install dependencies & Build

```bash
yarn && yarn run build-all
```

## Update Tools Configs

Firstly copy config files.

```bash
export SCRIPT_DEPLOY_RESULT_PATH=<your godwoken `scripts-deploy-result.json`>
export GODWOKEN_CONFIG_PATH=<your godwoken `config.toml`>
yarn run copy-configs
```

Or copy by yourself.

```bash
cp <your godwoken `scripts-deploy-result.json`> packages/tools/configs/scripts-deploy-result.json
cp <your godwoken `config.toml`> packages/tools/configs/godwoken-config.toml
yarn run convert-config-format # convert `godwoken-config.toml` to `godwoken-config.json`
```

For testnet

```bash
yarn run generate-testnet-configs
```

## Generate your lumos config

If run dev chain, lumos config should generated by yourself, and [this tool](https://github.com/classicalliu/lumos-config-generator) may help you.

For example, in linux system
```bash
wget https://github.com/classicalliu/lumos-config-generator/releases/download/v0.1.1/lumos-config-generator-linux-amd64 -O lumos-config-generator
chmod +x ./lumos-config-generator
./lumos-config-generator
# `config.json` is the generated lumos config file.
```

## Account operations

Run `node ./packages/tools/lib/account-cli.js --help` to see how to `deposit`, `deposit-sudt`, `transfer`, `withdraw` and `get-balance`.

```bash
LUMOS_CONFIG_FILE=<your lumos config file path> node ./packages/tools/lib/account-cli.js --help # for devnet
node ./packages/tools/lib/account-cli.js --help # for testnet
```

### Notes

If you switched to a new CKB chain, you should switch to a new indexer path `--indexer-path <your new path>` or just delete `indexer-data` dir.

## Polyjuice CLI

Run `node ./packages/tools/lib/polyjuice-cli.js --help` to see how to `creator creator account`, `deploy contract`, `call contract`.

```bash
node ./packages/tools/lib/polyjuice-cli.js --help # for devnet
ENABLE_TESTNET_MODE=true node ./packages/tools/lib/polyjuice-cli.js --help # for testnet
```

## Working devnet commands examples

How it works with godwoken-kicker config:

Deposit CKB:
```
LUMOS_CONFIG_FILE=/home/USERNAME/projects/godwoken-kicker/godwoken/deploy/lumos-config.json node ./packages/tools/lib/account-cli.js deposit -c 40000000000 -p 0x6cd5e7be2f6504aa5ae7c0c04178d8f47b7cfc63b71d95d9e6282f5b090431bf -l 0xD173313A51f8fc37BcF67569b463abd89d81844f
```

Deposit SUDT:
```
LUMOS_CONFIG_FILE=/home/USERNAME/projects/godwoken-kicker/godwoken/deploy/lumos-config.json node ./packages/tools/lib/account-cli.js deposit-sudt -m 100 -s 0x6f33df7e3fffb47794f9ca37643118ba79207ac92596a0555e9038828e547357 -p 0x6cd5e7be2f6504aa5ae7c0c04178d8f47b7cfc63b71d95d9e6282f5b090431bf -l 0xD173313A51f8fc37BcF67569b463abd89d81844f
LUMOS_CONFIG_FILE: /home/USERNAME/projects/godwoken-kicker/godwoken/deploy/lumos-config.json
```

### Copy configs from godwoken-kicker

```
cp /home/USERNAME/projects/godwoken-kicker/godwoken/deploy/scripts-deploy-result.json ./packages/tools/configs/scripts-deploy-result.json
```

### Tips

1. Each time you recreate godwoken-kicker deployment you need to remove `godwoken-examples/indexer-data` directory.